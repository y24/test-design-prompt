# 品質基準・目標値設計ガイド

## 1. このガイドの目的

本ガイドは、以下を入力として、

- 非機能候補一覧（`nfr_extraction_guide.md` の成果）
- 品質特性への暫定マッピング（`quality_model_overview_guide.md` の成果）

それらをもとに、ISO/IEC 25010 の非機能 7 特性について、

- 「どのような品質基準（クライテリア）を定めるか」
- 「それをどのように確認・評価するか（目標値・確認方法）」

を一貫した形式で設計するためのルールを示す。

ここで設計されたクライテリアは、

- プロジェクト内で議論・調整されるための **たたき台**
- テスト計画や運用設計に落とし込むための **橋渡し**

として機能することを目的とする。

---

## 2. 前提・インプット

LLM は、本ガイドに従ってクライテリアを設計するにあたり、少なくとも次を参照する。

- `rules.md`
  - 全体フロー、出力フォーマット、禁止事項 など
- `nfr_extraction_guide.md`
  - 非機能候補一覧（NFR-xxx）
- `quality_model_overview_guide.md`
  - 非機能候補ごとの品質特性候補タグ
- （必要に応じて）各特性別ガイド
  - `characteristic_specific_guides/*.md`

本ガイド自身は、「**共通の枠組み・フォーマット・考え方**」を定める。

---

## 3. クライテリアの定義と設計方針

### 3.1 クライテリアの定義

本ガイドにおける「品質基準（クライテリア）」は、

> 「ある品質特性に関して、このシステムが満たすべき状態や条件を、  
>  確認可能なレベルまで具体化したもの」

と定義する。

1つのクライテリアは、少なくとも以下を含む。

- どの品質特性を主として扱うか
- どのような観点で何を守りたいのか（概要説明）
- どのような方法で、それを確認・評価するのか
- 評価のための指標と、たたき台となる目標レベルの例

### 3.2 定性的・定量的のバランス

- 完全に厳密な数値目標を決めることが目的ではない。
- 重要なのは、
  - **何を確認するのか**
  - **どのような状況を NG とみなすのか**
  が具体的にイメージできるレベルまで言語化されていること。

そのため、

- 定性的な表現（例：「業務上許容できる範囲」「ユーザーがストレスを感じないレベル」）は、
  - それだけではクライテリアとして弱いが、
  - 「どの指標を見ればよいか」とセットであれば許容される。
- 数値は **「例」** として提示するにとどめ、  
  プロジェクトでの最終決定は人間に委ねる。

---

## 4. クライテリア情報項目（共通フォーマット）

LLM は、各クライテリアについて、可能な限り以下の項目を埋める。

| 項目名                    | 説明 |
|---------------------------|------|
| `criterion_id`            | クライテリアを一意に識別する ID （例：PE-001, REL-002, SEC-003 など）。品質特性ごとに連番でよい。 |
| `quality_characteristic`  | 主となる品質特性（性能効率性 / 互換性 / 使用性 / 信頼性 / セキュリティ / 保守性 / 移植性）。 |
| `related_quality_characteristics` | 関連する品質特性があれば列挙（任意）。 |
| `related_nfr_candidates`  | このクライテリアの元になった非機能候補 ID の一覧（例：`["NFR-001", "NFR-003"]`）。 |
| `criterion_title`         | クライテリアを一言で表した短い見出し。 |
| `criterion_description`   | 何を守るための基準か、どのような状態を目指すのかを説明する文。 |
| `verification_method`     | どのような手段で確認・評価するか（テスト種別・レビュー・モニタリング等）。 |
| `measurement_indicator`   | どのような指標・観測値を用いて評価するか。 |
| `target_level_example`    | 検討のたたき台となる目標レベル（数値・区分・条件等）の「例」。確定値ではないことを明示する。 |
| `priority`（任意）        | 重要度・優先度（例：High / Medium / Low や 1〜5 のスコアなど）。 |
| `related_documents`       | 根拠となるドキュメントの名称・章・節等（例：要件定義書 3.2.1、運用設計書 4.1 など）。 |

---

## 5. クライテリア設計の流れ（抽象レベル）

LLM は、1つのクライテリアを設計する際、概ね次の流れを辿る。

1. 関連する `nfr_candidate` をまとめる
   - 共通テーマを持つ候補（例：インポート処理の時間、ピーク時利用、注意書き）を束ねる。
2. 主となる品質特性を選ぶ
   - `quality_model_overview_guide.md` を参照しつつ、「何を守る話か？」を決める。
3. 「何をどうしたいか」を日本語で素直に書く
   - 「〇〇な場面で、△△が□□であること」という形で、`criterion_description` を組み立てる。
4. 確認方法を決める
   - 「この基準が守られていることは、どのような行為で確認できるか？」を考え、`verification_method` として書く。
5. 評価指標を決める
   - どの値・ログ・観測結果を見れば判断できるかを `measurement_indicator` に書く。
6. 目標レベルの例を置く
   - プロジェクトで調整される前提で、「このくらいを 1 つの目安とできそう」という例を `target_level_example` に示す。

---

## 6. 確認方法（verification_method）の設計

### 6.1 代表的な確認手段

クライテリアの確認手段として、次のような種別をよく用いる。

- テスト系
  - 性能試験 / 負荷試験
  - 機能テスト（非機能観点を含むもの）
  - 障害復旧試験（フェイルオーバー試験など）
  - セキュリティテスト（ペネトレーションテスト、脆弱性診断）
  - ユーザビリティ評価（ユーザテスト、ヒューリスティック評価）

- レビュー・静的分析系
  - 設計レビュー
  - コードレビュー
  - 設計書・運用設計書のレビュー
  - 静的解析ツールのレポート確認

- 運用・モニタリング系
  - 監視メトリクス（CPU / メモリ / レスポンス時間等）の確認
  - ログの定期的なレビュー（セキュリティログ、監査ログ）
  - アラート履歴の確認

### 6.2 書き方の例

- 「代表シナリオを用いた性能試験により確認する」
- 「設計レビューにより、冗長構成が適切に設計されていることを確認する」
- 「本番運用中の監視メトリクスにより、ピーク時の CPU 使用率・レスポンスタイムを継続的に監視する」

---

## 7. 評価指標（measurement_indicator）の設計

### 7.1 指標の種類

- 数値的な指標
  - 応答時間（ms, 秒）
  - 処理時間（秒, 分）
  - スループット（件/秒, 件/分）
  - エラー率（%）
  - 稼働率（%）
  - CPU / メモリ使用率（%）
  - バックアップ取得頻度・保管期間（回/日, 日数）

- 区分的な指標
  - 「問題なし / 注意 / 問題あり」
  - 「高 / 中 / 低」
  - 「Yes / No」

- 手順・ルールの有無
  - 「障害対応手順書の有無・更新状況」
  - 「ログ出力項目の定義有無」

### 7.2 注意点

- 指標は、「比較・改善ができる形」になっていることが望ましい。
- 指標が曖昧すぎる場合は、`notes` や後続の「問題点の指摘」で、
  - 「このクライテリアを定量的に評価するための指標が不足している」
  といった形で明示する。

---

## 8. 目標レベル（target_level_example）の考え方

### 8.1 目標レベルは「例」である

- `target_level_example` に記載する値・条件は、  
  あくまで「議論の出発点」としての例示であり、**プロジェクトで確定した値ではない**。
- LLM は、
  - 過去の類似システムの一般的な水準
  - 業務上の常識的な感覚  
  を参考にしつつ、**保守的すぎず、非現実的すぎない範囲**で値を提示する。

### 8.2 書き方のパターン

- 数値＋補足
  - 「平日日中帯のピーク時に、代表シナリオのレスポンスが 3 秒以内（例・要調整）」
- レンジ
  - 「CPU 使用率が通常時 70％未満、ピーク時でも一時的なスパイクを除き 85％未満（例・要調整）」
- 条件ベース
  - 「24時間 365日運用を前提とし、年 4時間以内の計画停止（バックアップ・メンテナンス）に収まること（例・要調整）」

「（例・要調整）」などの文言をつけることで、  
人間が後から修正する前提であることを明示しやすくする。

---

## 9. テンプレート（Markdown テーブル）

品質基準一覧は、`rules.md` で示した形式に従い、  
品質特性ごとにテーブルで整理する。

### 9.1 テーブルのひな型

```markdown
#### 性能効率性 に関する品質基準

| criterion_id | quality_characteristic | related_quality_characteristics | related_nfr_candidates | criterion_title                               | criterion_description                                                                                   | verification_method                                           | measurement_indicator                                  | target_level_example                                                                | priority | related_documents          |
|-------------|------------------------|---------------------------------|------------------------|-----------------------------------------------|----------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|--------------------------------------------------------|---------------------------------------------------------------------------------------|----------|----------------------------|
| PE-001      | 性能効率性             | 信頼性                          | NFR-001, NFR-003       | 月次インポート処理の完了時間                 | 月次締め処理における大量データインポートが、業務開始前までに安定して完了すること。                    | 代表シナリオを用いた性能試験、および本番相当環境での負荷試験により確認する。 | 月次インポート処理の完了時間、ピーク時の平均レスポンスタイム          | 平日日中帯に同時実行3件、100万件レコードのインポートで5分以内（例・要調整） | High     | 要件定義書 3.2.1, 運用設計書 4.1 |
````

---

## 10. Few-Shot 例

### 10.1 性能効率性のクライテリア例

**前提となる非機能候補（抜粋）：**

* NFR-001:
  「月次締め処理のデータインポートは、業務開始前の 2時間以内に完了すること。」

**クライテリア例：**

```markdown
| criterion_id | quality_characteristic | related_quality_characteristics | related_nfr_candidates | criterion_title                       | criterion_description                                                                 | verification_method                                           | measurement_indicator                              | target_level_example                                                         | priority | related_documents        |
|-------------|------------------------|---------------------------------|------------------------|---------------------------------------|----------------------------------------------------------------------------------------|--------------------------------------------------------------|----------------------------------------------------|-------------------------------------------------------------------------------|----------|--------------------------|
| PE-001      | 性能効率性             | 信頼性                          | NFR-001                | 月次インポート処理の完了時間         | 月次締め処理における代表的なデータ量を対象に、業務開始前までにインポート処理が完了すること。 | 代表的なデータ量・負荷条件を用いた性能試験、および結合テスト環境でのリハーサルにより確認する。 | インポート処理の完了時間、ピーク時の平均・最大レスポンスタイム | 月次本番データ量（例：100万件）を 1回のジョブで実行し、60分以内に完了（例・要調整） | High     | 要件定義書 3.2.1         |
```

---

### 10.2 セキュリティのクライテリア例

**前提となる非機能候補（抜粋）：**

* NFR-201:
  「システムへのアクセスは、社内ネットワークからのみに制限すること。」
* NFR-202:
  「全てのログイン試行について、ユーザーID・時刻・接続元IPを記録すること。」

**クライテリア例：**

```markdown
| criterion_id | quality_characteristic | related_quality_characteristics | related_nfr_candidates | criterion_title                           | criterion_description                                                                                           | verification_method                                                    | measurement_indicator                                  | target_level_example                                                                  | priority | related_documents        |
|-------------|------------------------|---------------------------------|------------------------|-------------------------------------------|------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------|--------------------------------------------------------|-------------------------------------------------------------------------------------------|----------|--------------------------|
| SEC-001     | セキュリティ           | 信頼性                          | NFR-201, NFR-202       | 社内ネットワーク限定アクセスとログイン監査 | システムへのアクセスを社内ネットワーク範囲に限定し、全ログイン試行について監査ログを取得できること。         | ネットワーク構成レビュー、ファイアウォール設定確認、テスト用アカウントでのログイン試験により確認する。 | ログイン成功/失敗時の監査ログ有無、記録されるIPアドレス・時刻・ユーザーID | 社内IP以外からのアクセスが遮断され、全ログイン試行が監査ログに記録されていることを確認（例・要調整） | High     | 要件定義書 5.1, 運用設計書 3.2 |
```

---

### 10.3 保守性のクライテリア例

**前提となる非機能候補（抜粋）：**

* NFR-301:
  「接続先 URL やタイムアウト値は、全て設定ファイルで変更可能とすること。」

**クライテリア例：**

```markdown
| criterion_id | quality_characteristic | related_quality_characteristics | related_nfr_candidates | criterion_title                       | criterion_description                                                                                 | verification_method                              | measurement_indicator                           | target_level_example                                                                  | priority | related_documents      |
|-------------|------------------------|---------------------------------|------------------------|---------------------------------------|--------------------------------------------------------------------------------------------------------|-------------------------------------------------|-----------------------------------------------|-------------------------------------------------------------------------------------------|----------|------------------------|
| MAI-001     | 保守性                 | 移植性                          | NFR-301                | 接続先設定の外部化                   | 接続先URLやタイムアウト値などの環境依存パラメータが、コード修正なしで設定ファイルから変更可能であること。 | 設計レビューおよび設定ファイルを用いた環境切替テストにより確認する。 | 設定ファイルで管理されるパラメータの一覧と、適用結果の確認手順 | ステージング環境→本番相当環境への接続先切替を、設定ファイルの変更のみで完了できること（例・要調整） | Medium   | 仕様書 4.3, 設計書 2.2 |
```

---

## 11. 注意事項・禁止事項（再掲）

1. **プロジェクト固有の確定値を「決めきらない」**

   * LLM は、経験則に基づく「ありそうな数値」を例示してよいが、
   * 「この値で確定である」とみなされる書き方は避ける。
   * 例：「〜とする。」ではなく、「〜を一つの目安とする（例・要調整）。」

2. **非現実的な数値を避ける**

   * 明らかに一般的なシステムでは達成不可能な数値（例：常に 0ms 応答、障害ゼロなど）は提示しない。
   * 実現可能性が微妙な場合は、`notes` に「要実現性検討」と明記してもよい。

3. **クライテリアとテスト設計を混同しない**

   * 本ガイドで作成するのは「何を満たすべきか」の基準であり、
   * 「どのテストケースを何本作るか」まではここで規定しない。
   * ただし、後続のテスト計画に寄与するよう、確認方法はできるだけ具体的に記述する。

---

以上のガイドに従い、LLM は `nfr_extraction_guide.md` で抽出された非機能候補と
`quality_model_overview_guide.md` による品質特性マッピングをもとに、
各品質特性ごとの品質基準・目標値を、共通フォーマットで設計すること。
