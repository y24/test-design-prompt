# 品質特性マッピングガイドライン

## 1. ガイドの目的

このガイドは、不具合チケットから読み取れる事象を、ISO/IEC 25010 の品質特性に一貫してマッピングするための指針を示す。

目的は以下の通り。

- 不具合の傾向を「品質特性」の観点で可視化する
- どの品質特性に対してテスト・レビューを強化すべきか判断する材料にする
- プロジェクトや担当者が変わっても、同じ基準でマッピングできるようにする

LLM はこのガイドを参照し、各不具合（もしくは不具合事象グループ）について、

- 主に影響を受ける品質特性（Primary）
- 必要に応じて、副次的に影響を受ける品質特性（Secondary）

を判断する。

---

## 2. ISO/IEC 25010 品質特性の概要

本ガイドで扱う品質特性は以下の 8 つとする。

| コード | 品質特性名         | 英語名                | ざっくりしたイメージ |
|--------|--------------------|-----------------------|----------------------|
| Q1     | 機能適合性         | Functional suitability | ちゃんと正しく動くか |
| Q2     | 性能効率性         | Performance efficiency | 速さ・資源の使い方   |
| Q3     | 互換性             | Compatibility          | 他の環境/システムと共存できるか |
| Q4     | 使用性             | Usability              | 使いやすいか・理解しやすいか |
| Q5     | 信頼性             | Reliability            | 安定して動き続けるか |
| Q6     | セキュリティ       | Security               | 守るべきものを守れているか |
| Q7     | 保守性             | Maintainability        | 直しやすさ・変更しやすさ |
| Q8     | 移植性             | Portability            | 別環境でも動かしやすいか |

※ 可能であれば、プロジェクトでよく使うサブ特性（例: 機能適合性の「正確性」、使用性の「操作性」など）は、チーム内で別途整理してもよい。

---

## 3. マッピングの基本方針

### 3.1 何を基準に判断するか

品質特性へのマッピングは、主に以下を基準に行う。

1. **ユーザー視点の影響**  
   - ユーザーがどう困るのか、どの体験が損なわれているか。
2. **システムの振る舞いのどの側面が問題か**  
   - 正しさ / 速さ / 安定性 / 使いやすさ / 安全性 / 変更のしやすさ など。

### 3.2 判断ルール

- **Primary を 1〜2 個に絞る**
  - なんでもかんでも複数特性に紐づけると分析がぼやけるので、主に影響する特性を 1〜2 個に限定する。
- **Secondary は必要な場合のみ**
  - どうしても外せない場合だけ、Secondary として追加する。
- **内部原因ではなく「現象」を優先**
  - 例: コードレビュー不足が原因でも、「計算結果が間違っている」なら機能適合性が Primary になる。
- **迷ったら理由をコメントする**
  - 「Q1 と Q5 で迷ったが、ユーザーが認識するのは正しさなので Q1 とした」など、判断理由を簡潔に残す。

---

## 4. 各品質特性ごとの典型的な不具合例

ここでは、代表的な不具合事象とそれに対応する品質特性の例を示す。

### Q1. 機能適合性 (Functional suitability)

**定義イメージ**  
- 必要な機能が揃っていて、その機能が正しく動作し、業務に適切に使える状態か。

**典型的な不具合例**

- 計算ロジックの誤り（税額、端数処理、合計値の不一致など）
- 条件分岐のミスにより、本来実行されるべき処理が実行されない
- 必須業務フローが実現できない（例: 必須の業務ステップが UI から到達できない）
- 検索結果が漏れる / 余計なものが含まれる
- 出力帳票の値が仕様と異なる

**よく対応する事象カテゴリの例**

- E01 計算ロジック不正
- E02 入力チェック不足（→ 不正な入力がそのまま受け入れられ、業務上誤った結果となる場合）
- E03 データ整合性不整合（機能の正しさに直結するもの）

---

### Q2. 性能効率性 (Performance efficiency)

**定義イメージ**  
- 応答速度、スループット、資源の使い方が妥当か。

**典型的な不具合例**

- 画面表示が非常に遅い、タイムアウトする
- バッチ処理に想定以上の時間がかかる
- 特定データ量を超えると極端に遅くなる
- 不必要にメモリを消費し、他機能に悪影響が出る

**よく対応する事象カテゴリの例**

- E06 性能・レスポンス遅延
- E11 バッチ・ジョブ異常（性能劣化が主原因の場合）

---

### Q3. 互換性 (Compatibility)

**定義イメージ**  
- 他のシステムや環境（OS / ブラウザ / デバイスなど）と問題なく共存・連携できるか。

**典型的な不具合例**

- 特定ブラウザのみ表示が崩れる
- モバイルだけ操作できない UI 要素がある
- 特定 OS バージョンでのみクラッシュする
- 他システムとの連携 API が特定環境下だけ失敗する

**よく対応する事象カテゴリの例**

- E10 互換性・環境依存動作
- E04 画面表示崩れ（特定ブラウザ/解像度だけの場合、互換性＋使用性）

---

### Q4. 使用性 (Usability)

**定義イメージ**  
- 学習しやすく、理解しやすく、操作しやすく、誤操作を防ぎやすいか。

**典型的な不具合例**

- ラベル・メッセージが実際の動作と一致しない
- エラーメッセージが意味不明・誤解を招く
- 項目配置・レイアウト崩れが原因で誤入力が発生しやすい
- 仮に機能としては動いているが、操作フローが直感的でなく導線が分かりづらい
- ヘルプ・マニュアルが実際の画面と乖離している

**よく対応する事象カテゴリの例**

- E04 画面表示・UI レイアウト崩れ
- E07 エラー処理・メッセージ不備
- E13 ドキュメント・ヘルプ不備

---

### Q5. 信頼性 (Reliability)

**定義イメージ**  
- 障害の起きにくさ、起きた後の復旧のしやすさ、一定期間安定して動作し続けるか。

**典型的な不具合例**

- 特定条件でのみ時々発生する不具合（インシデントとして蓄積されるもの）
- バッチ・サービスが不定期に落ちる
- 再試行やフェイルオーバーが機能しない
- データが蓄積されるにつれて異常動作が増えていく

**よく対応する事象カテゴリの例**

- E03 データ整合性不整合（継続的な運用で徐々にデータ壊れが広がる場合）
- E05 画面遷移・状態管理不正（セッション切れ、状態不整合など）
- E06 性能問題が原因でタイムアウト → 障害につながるケース
- E11 バッチ・ジョブ異常

---

### Q6. セキュリティ (Security)

**定義イメージ**  
- 機密性・完全性・可用性を守れているか。認証・認可・監査・改ざん防止などが適切か。

**典型的な不具合例**

- 権限のないユーザーがデータを閲覧/更新できてしまう
- パスワードが平文保存されている
- XSS / SQL Injection / CSRF などの脆弱性
- セッションハイジャックが容易な実装
- ログイン試行回数制限がない、脆弱なパスワードポリシー

**よく対応する事象カテゴリの例**

- E08 権限・アクセス制御不備
- E09 セキュリティ関連問題
- E02 入力チェック不足（攻撃ベクトルになりうる場合）

---

### Q7. 保守性 (Maintainability)

**定義イメージ**  
- ソフトウェアを理解しやすく、変更しやすく、テストしやすい状態か。

**典型的な不具合例**

- 小さな修正のたびに別機能が頻繁に壊れる（結合度が高すぎる）
- 特定モジュールに不具合が集中し、修正コストが極端に高い
- ログが不足していて、原因調査に非常に時間がかかる
- テストしづらい構造のため、簡単な変更でも網羅テストが必要になる

※ 保守性はチケットから直接読み取りにくいが、「同じモジュールで似た不具合が繰り返し発生」「修正のたびに別のところが壊れる」といった傾向が見える場合に注目する。

**よく関連する状況**

- 同一モジュールでの不具合再発
- 根本原因が十分に潰せていないことがログや履歴から分かるケース
- 「原因調査に多大な工数」が定常的に発生している記述がある場合

---

### Q8. 移植性 (Portability)

**定義イメージ**  
- 別プラットフォームや環境へ移しやすいか、設定変更でスムーズに動かせるか。

**典型的な不具合例**

- 本番環境へのデプロイのみ失敗する（環境依存の絶対パス・ハードコーディング）
- OS / DB / ミドルウェアバージョン変更で動かなくなる
- コンテナ化・クラウド移行の際に動作しない箇所が多発

※ 日常の不具合チケットでは直接扱われないことも多く、その場合は「特に顕著な傾向なし」としてよい。

---

## 5. 事象カテゴリ (E01〜E13) との対応例

`defect_trend_classification_guide.md` で定義した事象カテゴリと品質特性の代表的な対応例を示す。

> この表は「代表例」であり、常にこの通りにしなければならないわけではない。  
> ただし、特に理由がない限りはこの対応を基本とする。

| 事象コード | 事象カテゴリ                         | Primary 品質特性 | Secondary の例           |
|------------|--------------------------------------|------------------|--------------------------|
| E01        | 計算ロジック不正                    | Q1 機能適合性    | Q5 信頼性                |
| E02        | 入力チェック・バリデーション不足    | Q1 機能適合性    | Q6 セキュリティ / Q5 信頼性 |
| E03        | データ整合性・不整合                 | Q1 機能適合性    | Q5 信頼性                |
| E04        | 画面表示・UI レイアウト崩れ         | Q4 使用性        | Q3 互換性（環境依存時）  |
| E05        | 画面遷移・状態管理不正               | Q4 使用性        | Q5 信頼性                |
| E06        | 性能・レスポンス遅延                | Q2 性能効率性    | Q5 信頼性                |
| E07        | エラー処理・メッセージ不備           | Q4 使用性        | Q5 信頼性                |
| E08        | 権限・アクセス制御不備              | Q6 セキュリティ  | Q1 機能適合性            |
| E09        | セキュリティ関連問題                | Q6 セキュリティ  | Q5 信頼性                |
| E10        | 互換性・環境依存動作                | Q3 互換性        | Q2 性能効率性 / Q4 使用性 |
| E11        | バッチ・ジョブ異常                  | Q5 信頼性        | Q2 性能効率性 / Q1 機能適合性 |
| E12        | 設定・パラメータミス                | 状況による       | Q1 / Q2 / Q3 / Q5 など   |
| E13        | ドキュメント・ヘルプ不備            | Q4 使用性        | Q7 保守性                |

※ E12 は設定内容によって影響が大きく変わるため、個別に判断する。

---

## 6. LLM がマッピングする手順

LLM が 1 件の不具合事象（または事象グループ）を品質特性にマッピングする際は、以下の手順に従う。

1. **事象の要約**
   - タイトル・概要・再現手順・実施結果から、「ユーザー視点の不具合事象」を 1〜2 文で要約する。

2. **事象カテゴリ (E コード) の特定**
   - `defect_trend_classification_guide.md` に従い、E01〜E13 のいずれかに分類する（可能な場合）。

3. **事象カテゴリからの初期マッピング**
   - 上記の対応表を参照し、候補となる品質特性（Primary / Secondary）を一旦選択する。

4. **ユーザー影響の観点から見直し**
   - この不具合でユーザーが最も困っているのは何か？  
     - 正しさ / 速さ / 使いやすさ / 安全性 / 安定性 … のうち、最も重要なものが Primary。
   - 必要に応じて、候補を修正する。

5. **複数特性にまたがる場合の整理**
   - どうしても 2 つ以上外せない場合は、Primary を 1〜2 個に限定し、それ以外はコメントにとどめる。

6. **判断理由の簡潔な記述**
   - 「なぜその品質特性にマッピングしたのか」を 1〜2 行で残す。  
     - 例: 「ユーザーが認識する問題は計算結果の誤りであり、正しさが主な関心事のため Q1 とした。」

---

## 7. 不明点・あいまいなケースの扱い

以下のような場合、LLM は推測で補完せず、ユーザーに質問するか、保留扱いとしてもよい。

- チケットの情報が不足しており、不具合事象がよくわからない
- 不具合がどの業務・機能に属するか不明で、それにより品質特性の判断も変わりそうな場合
- 「セキュリティ起因か、単なるバグか」で大きく扱いが変わるケース

その際は、必要な追加情報の例を挙げたうえで、

- 「現時点では Q1 と判断したが、権限仕様の詳細によっては Q6 の色合いが強くなる可能性がある」

のように、不確実性を明示する。

---

## 8. 出力時のフォーマット例

LLM が個々の不具合事象を品質特性にマッピングする際、以下のような形式でまとめると分析に利用しやすい。

### 不具合ID: BUG-1234

- 要約:
  - 金額計算画面にて、消費税率 10% の明細を含む場合に合計金額が 1 円多く表示される。

- 事象カテゴリ:
  - E01 計算ロジック不正

- 品質特性マッピング:
  - Primary: Q1 機能適合性
  - Secondary: Q5 信頼性（継続運用時の決算への影響が大きいため）

- 判断理由:
  - ユーザーが直面する主な問題は「金額が正しくない」ことであり、業務の正しさに直接影響するため。
