# 不具合傾向分析 rules.md

## 1. このファイルの目的

このファイルは、LLM がプロダクトで発生した不具合チケット一覧を入力として受け取り、

- 不具合の発生傾向
- 品質特性モデル（ISO/IEC 25010）に基づいた傾向
- 今後予想される不具合事象
- 強化すべきテスト種別

を、一貫した手順と判断基準に基づいて分析するための運用手順を定義する。

LLM は本ファイルと以下の 3 つのガイドをセットで参照し、分析を行うこと。

- `defect_trend_classification_guide.md`  
- `quality_characteristics_mapping_guide.md`  
- `test_type_recommendation_guide.md`  

---

## 2. 入力として想定する情報

### 2.1 不具合チケットの情報

分析対象の不具合チケットには、可能な限り以下の情報が含まれていることを前提とする。

- タイトル、概要
- State（解決状況）
- Severity（重要度）
- 前提条件
- 再現手順
- 実施結果
- 期待される結果
- 発生環境（OS / ブラウザ / 端末 / バージョンなど）
- テストフェーズ（単体 / 結合 / システム / 受け入れ / 本番など）
- テスト種別（機能テスト / シナリオテスト / 回帰テスト / 性能テスト / etc）
- 検出方法（テストケース / 探索的テスト / 自動テスト / モニタリング / ユーザー申告 etc）
- ブロッカー（true/false）
- 原因分類（設計 / 実装 / テスト / 設定 / データ / 運用 etc）
- 報告日
- 報告者
- 完了日
- 完了理由

さらに、可能であれば以下の情報も含まれていることが望ましい。

- モジュール名 / 機能名 / 画面 ID / API 名 / バッチ名
- 対象プロダクト / サービス名 / バージョン / リリース番号
- 業務・ビジネスプロセスに関する情報（例: 売上計上、請求処理 など）

### 2.2 データ形式

- 不具合チケットは、JSON 配列 / CSV / 表形式など、一覧として与えられることを想定する。
- フィールド名と意味が不明な場合、LLM は推測で補完せず、ユーザーに質問して確認する。

---

## 3. 参照するガイドライン

LLM は分析にあたり、以下のガイドを順番に利用する。

1. **`defect_trend_classification_guide.md`**
   - 不具合を「位置情報軸」「事象カテゴリ」「原因軸」「業務軸」「補助軸（テストフェーズ／種別／検出方法）」で分類するためのガイド。

2. **`quality_characteristics_mapping_guide.md`**
   - 各不具合事象を ISO/IEC 25010 の品質特性（Q1〜Q8）にマッピングするためのガイド。

3. **`test_type_recommendation_guide.md`**
   - 不具合傾向と品質特性の偏りから、「どのテスト種別をどの領域で強化すべきか」を導出するためのガイド。

LLM は、これらのガイドに記載された手順・カテゴリ・例を優先的に用いること。

---

## 4. 分析全体のフロー

LLM は、以下のステップに従って分析を行う。

### Step 0: 前提条件・分析範囲の確認と不明点の整理

1. 入力データ全体から、以下を整理して明示する。
   - 分析対象期間（最初の報告日〜最後の報告日）
   - 対象プロダクト / バージョン / リリース
   - チケット総数
2. 明らかに欠損・不整合が多いフィールドがあれば列挙し、  
   そのフィールドを使った分析結果が「参考レベル」であることを明示する。
3. プロジェクト固有の用語・モジュール名・業務名などで意味が不明なものがあれば、
   - 推測で決めずにユーザーに質問する。
   - 質問が間に合わない場合は、その不確実性をコメントとして残したうえで分析を行う。

---

### Step 1: 不具合チケットの分類（defect_trend_classification_guide の適用）

各不具合チケットに対し、`defect_trend_classification_guide.md` に従って以下を付与・正規化する。

1. **位置情報軸**
   - プロダクト / サブシステム / モジュール / 機能 / 画面 / API / バッチ など
   - 少なくとも「モジュール」または「機能」のレベルを特定することを目標とする。

2. **不具合事象軸（E コード）**
   - 事象カテゴリ（E01〜E13）を 1 つ以上特定する。
   - ユーザーが最初に認識する事象を Primary とする。

3. **原因軸（C コード）**
   - 原因カテゴリ（C01〜C99）を特定する。
   - チケットに原因が明記されていない場合、  
     明らかに判断できるケース以外は C99（不明）としてよい。

4. **業務・ビジネスプロセス軸（B コード）**
   - 再現手順や前提条件から、どの業務フローに属するかを B01〜B99 で表現する。

5. **補助軸の正規化**
   - テストフェーズ
   - テスト種別
   - 検出方法  
   を、ガイド内の正規化ルールに従って標準化する。

> この Step の結果は、後続の集計・分析の「生データ」となる。  
> 可能であれば、中間的に表形式（チケットID × 各軸）でまとめる。

---

### Step 2: 分布・傾向の可視化（集計フェーズ）

Step 1 で付与した分類情報を用いて、以下の観点から分布・傾向を整理する。

1. **位置情報軸の分布**
   - モジュール別 / 機能別 / 画面別の不具合件数・割合
   - 不具合が集中しているモジュール・機能の特定

2. **事象カテゴリ（E コード）の分布**
   - E01〜E13 の件数・割合
   - 特定の事象カテゴリが偏って発生しているかどうか

3. **原因カテゴリ（C コード）の分布**
   - C01〜C99 の件数・割合
   - 「要件・仕様起因」「設計起因」「実装起因」「テスト起因」などの傾向

4. **業務・ビジネスプロセス軸の分布**
   - B01〜B99 ごとの不具合件数・割合
   - どの業務フローにリスクが集中しているか

5. **補助軸の分布**
   - テストフェーズ別
   - テスト種別別
   - 検出方法別（テストケース / 探索的 / 自動テスト / モニタリング / ユーザー申告 etc）

このフェーズでは主に「どこに不具合が多いか」「どういう種類の不具合が多いか」を定量的に把握する。

---

### Step 3: 品質特性へのマッピング（quality_characteristics_mapping_guide の適用）

`quality_characteristics_mapping_guide.md` に従い、各不具合（または類似事象のグループ）に対して、

- Primary 品質特性（必須、1〜2 個）
- Secondary 品質特性（必要に応じて）

を割り当てる。

具体的な手順は以下。

1. 各不具合事象を 1〜2 文で要約する。
2. Step 1 で付与した事象カテゴリ（E コード）を確認する。
3. quality_characteristics_mapping_guide の「E コードと Q コードの対応表」を参照し、初期候補を選ぶ。
4. ユーザー視点の影響を考慮し、Primary / Secondary を最終決定する。
5. 判断理由を簡潔にメモ（例: 「計算結果の誤りであり、機能の正しさが最重要のため Q1」）。

その後、全体として以下を集計する。

- 品質特性（Q1〜Q8）ごとの不具合件数・割合
- 品質特性 × モジュール / 機能 / 業務 の組み合わせ
- 特定の品質特性に偏っているかどうか

---

### Step 4: 不具合の発生傾向の整理

Step 2〜3 の結果を踏まえ、次の観点から「不具合の発生傾向」を文章としてまとめる。

1. **機能・業務に基づく傾向**
   - どの機能・業務に不具合が集中しているか
   - 業務フロー全体のどの部分で問題が起きやすいか

2. **モジュール / 画面別の傾向**
   - 不具合頻度が高いモジュール / 画面
   - 高 Severity / ブロッカー が多いモジュール

3. **テストフェーズ / テスト種別 / 検出方法の傾向**
   - 遅いフェーズ（UAT / 本番）で多く検出されている領域
   - 探索的テストでしか見つかっていないような不具合
   - 自動テストでは検出されていないが、手動テストで多く見つかる領域

4. **原因カテゴリの傾向**
   - 要件・設計・実装・テストのどこに問題が偏っているか

5. **品質特性（Q1〜Q8）の傾向**
   - 機能適合性／性能効率性／使用性／信頼性／セキュリティ など、どの特性の問題が多いか
   - 特定の品質特性が特定のモジュール・業務に集中しているか

ここでは、「どこに・どんな種類の・どの品質観点の不具合が偏っているか」を説明する。

---

### Step 5: 今後予想される不具合事象の想定

Step 4 の傾向から、「今後起こりそうな不具合」を以下の観点で推測する。

1. **同一モジュール / 業務での類似不具合**
   - 既に発生している事象パターンのバリエーション（境界条件、データパターン、組み合わせ違い）
2. **業務フローの前後での波及**
   - 前工程と後工程のデータ連携・状態遷移に関連する潜在的な不具合
3. **品質特性の波及**
   - 機能適合性の問題が信頼性／使用性にも波及しうるケース など
4. **テストが手薄な領域に起因するもの**
   - 探索的テストでしか見つかっていない領域
   - テストフェーズの後ろでだけ見つかっている領域

可能な限り、「業務シナリオ」や「テストケースの粒度」に落とし込んで記述する。

---

### Step 6: 強化すべきテスト種別の特定（test_type_recommendation_guide の適用）

`test_type_recommendation_guide.md` に従い、不具合の傾向と品質特性の偏りから、「強化すべきテスト種別」を導出する。

手順は以下。

1. Step 4〜5 の内容をもとに、
   - 品質特性（Q1〜Q8）ごとの課題の強さ
   - リスクの高い組み合わせ（高 Severity / ブロッカー × 特定業務 / モジュール × 特定品質特性）
   を整理する。

2. 各品質特性について、ガイドに示された「推奨テスト種別候補」をリストアップする。

3. 複数の品質特性から同じテスト種別が挙がる場合、それらを統合し、
   - 対象モジュール / 機能 / 業務
   - 目的（どの品質特性のリスクを下げるか）
   - 根拠（どの不具合傾向に基づくか）
   をまとめる。

4. テスト種別ごとに優先度をつける。
   - 例: 高 / 中 / 低、または 1〜3 段階 など  
   - 優先度は主に「リスク（頻度 × 影響度）」と「現状のテスト不足具合」で判断する。

---

### Step 7: まとめとアクション案の提示

最後に、以下の観点で結果をまとめる。

1. **重要ポイント（3〜5 個程度）**
   - 不具合傾向として特に重要なもの
   - リスクが高い領域
2. **短期的アクション**
   - 次のテストサイクルや直近リリースで実施すべきテスト強化
   - 具体的なテスト種別 × 対象モジュール／業務
3. **中期的アクション**
   - テストプロセス・テスト設計・自動テスト整備・レビュー体制などの改善案
4. **今後のモニタリング指標の案**
   - 「どの指標を追うと改善効果が見えやすいか」を簡潔に提案してもよい。

---

## 5. 出力形式（Markdown 構成）

LLM は最終的な分析結果を、Markdown 形式で以下の構成を基本として出力する。

```markdown
# 不具合傾向分析レポート

## 1. 分析対象と前提条件
- 分析対象期間:
- 対象プロダクト / バージョン:
- チケット総数:
- データ上の制約・注意点:

## 2. 不具合の発生傾向
### 2-1. 機能・業務に基づく傾向
- 概要:
- 要注意の機能 / 業務:

### 2-2. モジュール / 画面別の傾向
- 概要:
- 不具合が集中しているモジュール / 画面:

### 2-3. テストフェーズ / テスト種別 / 検出方法の傾向
- 概要:
- 特徴的なパターン:

### 2-4. 原因カテゴリの傾向
- 概要:
- 要件・設計・実装・テストのどこに偏りがあるか:

## 3. 品質特性モデル（ISO/IEC 25010）に基づく傾向
- 品質特性ごとの不具合分布のサマリ
  - Q1 機能適合性:
  - Q2 性能効率性:
  - Q3 互換性:
  - Q4 使用性:
  - Q5 信頼性:
  - Q6 セキュリティ:
  - Q7 保守性:
  - Q8 移植性:

（各特性について、代表的な不具合例や、集中しているモジュール / 業務があれば記載する）

## 4. 今後予想される不具合事象
- 予想される事象パターン 1:
  - 想定シナリオ:
  - 背景となる既存の不具合傾向:
  - 関連する品質特性:
- 予想される事象パターン 2:
  - ...

## 5. 強化すべきテスト種別
- テスト種別 A:
  - 種別名 / コード（例: T02 業務シナリオテスト）:
  - 対象モジュール / 業務:
  - 主に低減できる品質リスク（Q1〜Q8）:
  - 強化が必要な理由（不具合傾向・品質特性の観点から）:

- テスト種別 B:
  - ...

## 6. まとめと推奨アクション
- 重要ポイント（最大 5 個程度）:
- 短期的に着手すべきこと:
- 中期的に検討すべきこと:
- 今後モニタリングしたい指標の例:
````

不要な章がある場合は省略してよいが、その場合は「今回は分析対象データの制約により省略した」など、理由を明示することが望ましい。

---

## 6. 不明点・あいまいさの扱い

分析にあたり、不明な用語や理解できない記述について情報が必要な場合は、決して推測で補完せず、ユーザーに質問する。

特に質問が必要になりやすいポイントの例:

* モジュール名・業務名など、プロジェクト固有の用語の意味
* 「テスト種別」「テストフェーズ」の定義（プロジェクトによって呼び方が違う場合）
* 原因分類や Severity の定義
* 対象期間・対象リリースの範囲

質問ができない or 回答が得られていない場合は、その不確実性を明示したうえで、

* 「この前提が正しければ〜と判断できる」
* 「定義によっては結論が変わる可能性がある」

といった形で、前提条件つきの分析結果として提示すること。

---

## 7. この rules.md と 3 ガイドの関係

* `rules.md`
  → 「全体の流れ」と「レポートとしてどうまとめるか」を定義する。

* `defect_trend_classification_guide.md`
  → 不具合をどんな軸で分類し、生データをどう整えるかを定義する。

* `quality_characteristics_mapping_guide.md`
  → 各不具合をどの品質特性（ISO/IEC 25010）に紐づけるかを定義する。

* `test_type_recommendation_guide.md`
  → その結果から、どのテスト種別をどう強化するかの判断基準を定義する。

LLM は、3 つのガイドを参照しながら、この rules.md で定義されたフローに沿って分析を行い、最終的なレポートを Markdown で出力すること。
