# テスト種別強化ガイドライン

## 1. ガイドの目的

このガイドは、不具合傾向分析（rules.md）および

- defect_trend_classification_guide.md  
- quality_characteristics_mapping_guide.md  

で行われた分類・マッピング結果をもとに、

- どのテスト種別を
- どの領域に対して
- どのような目的で

強化すべきかを、一定の判断基準に基づいて導き出すための指針を示す。

LLM は本ガイドに従い、不具合の発生傾向と品質特性の偏りから、

- 強化候補となるテスト種別のリストアップ
- 各テスト種別を強化する理由
- 優先度と対象領域（モジュール / 機能 / 業務）

を明確に提示する。

---

## 2. 前提となる入力情報

本ガイドは、以下の情報が既に分析済みであることを前提とする。

1. **不具合傾向の分類結果**
   - defect_trend_classification_guide.md に従って分類された結果
   - 位置情報軸（モジュール / 機能 / 画面）
   - 不具合事象軸（E01〜E13）
   - 原因軸（C01〜C99）
   - 業務・ビジネスプロセス軸（B01〜B99）
   - 補助軸（テストフェーズ / テスト種別 / 検出方法）

2. **品質特性マッピング結果**
   - quality_characteristics_mapping_guide.md に従い、
   - 各不具合（または事象グループ）に対して、
     - Primary / Secondary の品質特性（Q1〜Q8）が付与されていること。

3. **定量的な情報（可能であれば）**
   - 不具合件数、Severity、ブロッカー有無
   - テストフェーズ / テスト種別ごとの不具合件数
   - モジュール別・機能別の不具合件数

これらをもとに、LLM は「どのテスト種別を強化すると効果的か」を判断する。

---

## 3. テスト種別の標準カテゴリ

本ガイドで扱う代表的なテスト種別は以下とする。

| コード | テスト種別                 | 概要 |
|--------|----------------------------|------|
| T01    | 機能テスト（画面/API 単位） | 単一画面・単一 API の機能要件を確認するテスト |
| T02    | 業務シナリオテスト / E2E   | 実際の業務フローに沿って複数機能を組み合わせて確認するテスト |
| T03    | 回帰テスト                 | 変更の影響が想定される既存機能の再確認テスト |
| T04    | 性能テスト / 負荷テスト    | レスポンス・スループット・リソース使用状況を確認するテスト |
| T05    | セキュリティテスト         | 脆弱性・権限・認証/認可に関するテスト |
| T06    | 互換性テスト               | OS / ブラウザ / デバイス / 解像度など環境差異に関するテスト |
| T07    | 設定 / 構成 / インフラ系テスト | 設定値・環境差異・インフラ構成を検証するテスト |
| T08    | データ移行 / マイグレーションテスト | 旧システム/旧バージョンからのデータ移行を検証するテスト |
| T09    | 探索的テスト               | テスト設計者の知見に基づいて自由度高く行うセッション型テスト |
| T10    | 自動テスト（ユニット）     | ソースコードレベルの単体テスト（自動化） |
| T11    | 自動テスト（API）          | API レベルでの自動テスト |
| T12    | 自動テスト（UI / E2E）     | ブラウザ・画面操作を含む自動 E2E テスト |

必要に応じて、プロジェクト固有のテスト種別を追加してよい。その場合、本ガイド末尾の「9. プロジェクト固有の定義」に追記すること。

---

## 4. 判断の基本方針

### 4.1 何を強化するか決める基本軸

テスト種別の強化は、主に以下の観点を組み合わせて判断する。

1. **発生している不具合の傾向**
   - どの事象カテゴリ（E01〜E13）が多いか
   - どのモジュール / 機能 / 業務で多いか
   - どのテストフェーズ / 検出方法で多く見つかっているか

2. **品質特性（Q1〜Q8）の偏り**
   - どの品質特性に属する不具合が多いか
   - 特定の品質特性に対するテストが手薄である可能性はないか

3. **リスク（頻度 × 影響度）の高さ**
   - Severity, ブロッカー, 業務影響度 等を考慮し、優先的に対処すべき領域を特定する。

4. **どの段階で見つかっているか**
   - 遅いフェーズ（システムテスト / UAT / 本番）での検出が多い領域は、より早いフェーズのテスト強化が必要。

### 4.2 LLM に求める姿勢

- **テスト種別の「名前」だけでなく、「具体的に何を強化するのか」を書くこと**
  - 例: 「業務シナリオテストを強化」ではなく、「〇〇業務の〇〇〜〇〇のフローをカバーする業務シナリオテストを増やす」のように記載する。
- **分析に使った根拠を明示すること**
  - 「このテスト種別を強化するべき」という主張ごとに、関連する不具合傾向・品質特性をセットで示す。
- **推測で決め打ちしないこと**
  - テストプロセスや現状のテストカバレッジが不明な場合は、その前提を明示し、必要に応じてユーザーに質問する。

---

## 5. 品質特性ごとの推奨テスト種別

品質特性（Q1〜Q8）が主な課題となっている場合に、特に強化候補となるテスト種別の例を示す。

### Q1. 機能適合性が課題のとき

**典型例**
- 計算ロジック不正（E01）
- 入力チェック不足で不正データが受け入れられる（E02）
- データ整合性問題（E03）

**推奨テスト種別**

- T01: 機能テスト（画面 / API 単位）
  - 境界値、異常系、例外パターンを含めたテストケースの拡充
- T02: 業務シナリオテスト / E2E
  - 業務フロー全体としての一貫性（前工程 → 後工程）を確認
- T10: 自動テスト（ユニット）
  - 計算ロジックや条件分岐のユニットテスト強化

---

### Q2. 性能効率性が課題のとき

**典型例**
- レスポンス遅延、タイムアウト（E06）
- バッチ処理が時間内に終わらない（E11）

**推奨テスト種別**

- T04: 性能テスト / 負荷テスト
  - 代表的な業務シナリオに対する負荷テストの追加
- T02: 業務シナリオテスト
  - 性能問題が顕在化しやすいフロー（大量検索、集計、エクスポートなど）の確認
- T07: 設定 / 構成テスト
  - 本番想定の設定（接続プール、タイムアウト値など）の検証

---

### Q3. 互換性が課題のとき

**典型例**
- 特定ブラウザ/OS/解像度でのみ画面崩れ・動作不良（E04, E10）

**推奨テスト種別**

- T06: 互換性テスト
  - サポート対象ブラウザ / OS / 解像度の組み合わせでの確認
- T12: 自動テスト（UI / E2E）
  - クロスブラウザ自動テストの導入・拡充

---

### Q4. 使用性が課題のとき

**典型例**
- 表示崩れ（E04）
- エラーメッセージ不備（E07）
- ヘルプ・ドキュメント不備（E13）

**推奨テスト種別**

- T02: 業務シナリオテスト
  - 開発者以外の視点（QA、ビジネスユーザー）での UX を確認
- T09: 探索的テスト
  - 実際の利用シーンに近い自由な操作で、違和感・分かりにくさを発見
- （補足アクション）UI レビュー / UX レビュー
  - 形式上はテストではないが、併記して推奨してよい

---

### Q5. 信頼性が課題のとき

**典型例**
- バッチ・ジョブの不安定な終了（E11）
- 状態管理の不整合（E05）
- データ整合性問題が継続的に発生（E03）

**推奨テスト種別**

- T02: 業務シナリオテスト / 長期連続利用シナリオ
  - 長時間利用・複数日またぎのシナリオでの確認
- T03: 回帰テスト
  - 過去に不具合が発生したモジュール/機能に対する回帰テストセットの整備
- T08: データ移行 / マイグレーションテスト
  - 運用中データの増加・移行による不整合を検出

---

### Q6. セキュリティが課題のとき

**典型例**
- 権限チェック不備（E08）
- 脆弱性（XSS / SQL Injection 等）（E09）

**推奨テスト種別**

- T05: セキュリティテスト
  - 権限マトリクスに基づくテスト
  - 代表的な脆弱性へのテスト（もしくはツール導入）
- T02: 業務シナリオテスト
  - 権限の異なるユーザーによるシナリオ確認
- （補足）脆弱性診断ツールの導入・定期実行

---

### Q7. 保守性が課題のとき

**典型例**
- 同じモジュールでの不具合再発
- 小さな変更で他機能が頻繁に壊れる

**推奨テスト種別**

- T03: 回帰テスト
  - 過去の不具合に対応するテストケースを回帰テストスイートとして維持する
- T10 / T11 / T12: 自動テスト
  - 影響範囲が広いモジュールに対し、自動回帰テストを整備する

---

### Q8. 移植性が課題のとき

**典型例**
- 本番環境や別クラウド環境でのみ動作しない
- OS / DB のバージョンアップで不具合多発

**推奨テスト種別**

- T07: 設定 / 構成 / インフラ系テスト
  - 環境差異を考慮したテストケースの整備
- T06: 互換性テスト
  - 対応プラットフォーム間での動作確認

---

## 6. 不具合傾向からテスト種別を選ぶ典型パターン

ここでは、よくある不具合傾向ごとに、「こういうときはこう強化する」というパターンを示す。

### パターン A: 計算系 / ロジック系不具合が特定モジュールに集中

- 傾向:
  - E01（計算ロジック不正）が多い
  - Q1 機能適合性が主な品質特性
  - 特定モジュール（例: 料金計算、税計算）に集中

- 推奨テスト種別:
  - T10: 自動テスト（ユニット）の強化
    - ロジックをユニットテストでカバーし、境界値・異常系を細かくテスト
  - T01: 機能テストのテストケース拡充
    - 代表的なパターンに加え、極端な値・組み合わせパターンを追加
  - T03: 回帰テスト
    - 過去の不具合事例を元に、再発防止のテストを固定化

---

### パターン B: 受け入れテスト / 本番で初めて見つかる不具合が多い

- 傾向:
  - UAT / 本番フェーズでの検出が多い
  - 業務シナリオ全体での不備、データ移行ミスなど

- 推奨テスト種別:
  - T02: 業務シナリオテスト
    - 本番と同様のデータ・ロール・設定で事前に業務フローを実行
  - T08: データ移行 / マイグレーションテスト
    - 本番データに近いテストデータでの移行検証
  - T03: 回帰テスト
    - UAT / 本番で見つかった不具合を再現するテストを回帰用に組み込む

---

### パターン C: 性能問題やタイムアウトが特定機能に集中

- 傾向:
  - E06（性能・レスポンス遅延）、E11（バッチ異常）が多い
  - Q2 性能効率性、Q5 信頼性が課題

- 推奨テスト種別:
  - T04: 性能テスト
    - 該当 API / 画面 / バッチに対して、ピーク時負荷を想定したテストを実施
  - T02: 業務シナリオテスト
    - 実際の利用フローの中で、性能劣化が顕在化しやすい箇所を特定
  - T07: 設定 / 構成テスト
    - タイムアウト値、スレッド数、接続プールなどの設定検証

---

### パターン D: 探索的テストでしか見つかっていない不具合が多い

- 傾向:
  - 検出方法「探索的」が多く、「テストケース」ではあまり検出されていない
  - 想定外の操作、組み合わせでの不具合

- 推奨テスト種別:
  - T02: 業務シナリオテスト
    - 実際の業務ユースケースをより網羅的にカバーする
  - T01: 機能テストのテストケース見直し
    - 探索的テストで見つかった事例を、今後のテストケースに取り込む
  - T09: 探索的テストの継続強化
    - ただし、「探索的でしか見つからない」のではなく、「探索的で見つかった観点を形式化する」方向を推奨

---

### パターン E: 特定ブラウザ / OS でのみ発生する UI 不具合が多い

- 傾向:
  - E04, E10 が多く、環境依存
  - Q3 互換性、Q4 使用性が課題

- 推奨テスト種別:
  - T06: 互換性テスト
    - サポート対象環境の組み合わせを整理し、優先度に応じたテスト計画を立てる
  - T12: 自動テスト（UI / E2E）
    - 主要ブラウザに対するスモークテストを自動化

---

## 7. LLM による推奨テスト種別の導出手順

LLM が「強化すべきテスト種別」をまとめる際は、以下の手順に従う。

1. **不具合傾向の要約**
   - どのモジュール / 業務 / 品質特性で不具合が多いかを簡潔に要約する。

2. **リスクの高い組み合わせの抽出**
   - 例: 「高 Severity × 受け入れテスト × Q1 機能適合性」など

3. **品質特性（Q1〜Q8）ごとの課題レベル判定**
   - 多くの不具合が紐づいている品質特性を「課題レベルが高い」と捉える。

4. **品質特性ごとに推奨テスト種別候補をリストアップ**
   - 本ガイドの第 5 章を参照し、候補を挙げる。

5. **重複するテスト種別を統合し、優先度付け**
   - 複数の品質特性から同じテスト種別が候補として挙がる場合、それらを統合し、
     - 不具合件数
     - Severity / ブロッカー数
     - 業務影響度
     などを加味して優先度を付ける。

6. **各テスト種別ごとに「対象」「目的」「根拠」を明示**
   - 対象: どのモジュール / 機能 / 業務 / フェーズ
   - 目的: どの品質特性のリスクを下げるためか
   - 根拠: どの不具合傾向からその判断に至ったか

---

## 8. 出力フォーマット例

最終レポート内の「強化すべきテスト種別」セクションは、以下のような形式を基本とする。

```markdown
## 5. 強化すべきテスト種別

### 5-1. 優先度高: 業務シナリオテスト（T02）

- 対象:
  - モジュール: 売上登録、請求書発行
  - 業務: 受注〜売上計上〜請求書発行の一連のフロー
- 目的:
  - Q1 機能適合性、Q5 信頼性の向上
- 根拠:
  - 売上計上〜請求にまたがる計算不整合（E01, E03）が複数発生している
  - 不具合の多くがシステムテスト〜受け入れテスト段階で発見されており、フロー全体の事前検証が不足している

### 5-2. 優先度中: 自動テスト（ユニット）（T10）

- 対象:
  - 金額計算ロジック、割引計算ロジック
- 目的:
  - ロジック部分の再発防止（Q1 機能適合性）
- 根拠:
  - 計算ロジック不正（E01）が同一モジュール内で複数回発生している

### 5-3. 優先度中: 性能テスト（T04）

- 対象:
  - 売上一覧画面の検索機能
- 目的:
  - Q2 性能効率性の改善
- 根拠:
  - 大量データ条件下でのタイムアウト（E06）が報告されている
````
