# rules.md - LLM による機能一覧抽出および機能テスト設計ルール

## 1. 目的

この文書は、アプリケーションの利用手順書・仕様書・要件定義書などのドキュメントを入力として、LLM が以下の 2 段階の作業を行うための共通ルールを定義する。

1. **機能一覧の抽出**
2. **機能テストの設計**

LLM は必ず本ファイルを先に参照し、ここで定めたルールに従って、
`function_identify_guide.md` および `functional_test_design_guide.md` の手順を実行する。

---

## 2. 前提条件と入力・出力

### 2.1 前提

* 入力ドキュメントには、アプリケーションの機能や画面遷移が分かる情報が含まれていることを前提とする。

  * 例：操作マニュアル、業務フロー図、画面仕様書、要件定義書など
* ドキュメントの粒度や品質にはばらつきがある可能性があるため、LLM は不明点や曖昧な点を「推測」と「明示された記述」とを区別して扱う。
* テストの対象は、基本的には「業務上の観点から意味のあるユーザー操作・処理単位」とする。

### 2.2 入力

LLM が扱う主な入力は次のとおり。

* アプリケーションに関する各種ドキュメント（利用手順書、仕様書、要件定義書など）
* 本ファイル：`rules.md`
* 詳細手順ファイル：

  * `function_identify_guide.md`
  * `functional_test_design_guide.md`

### 2.3 出力

LLM は最終的に以下の 2 ファイルを出力する。

1. `result/function_list.md`

   * 機能一覧（ツリー構造 + 重要度）の一覧
2. `result/functional_test_cases.md`

   * 機能テストのテストケース一覧（テーブル形式）

---

## 3. 用語の定義

* **機能**
  アプリケーションがユーザーまたは他システムに提供する、意味のある処理・操作・振る舞いの単位。
  例：

  * 「請求書を新規登録する」
  * 「明細行を追加・削除する」
  * 「登録済み請求書を PDF 出力する」

* **機能カテゴリ**
  機能をグルーピングする分類。画面単位、業務プロセス単位、モジュール単位など、ドキュメントから妥当な粒度で決める。

* **重要度**
  アプリケーション・業務上の観点から、機能がどれだけ重要かを表すランク。
  例：`高 / 中 / 低` などのランク付けを行う。

* **機能テスト**
  単一機能、または密接に関連する小さな複数機能単位で、入力・処理・出力およびバリデーションやエラー処理を確認するテスト。

---

## 4. 全体ルール

### 4.1 LLM の役割

あなた（LLM）は「アプリケーションの機能一覧整備と機能テスト設計を支援するテスト設計アシスタント」として動作する。
以下を重視する。

* ドキュメントに基づいた**根拠のある解釈**
* 重要度に応じた**テスト設計の優先度付け**
* 後続の人間が読みやすい**構造化された出力**

### 4.2 言語・記法

* 出力は特に指定がない限り **日本語** とする。
* Markdown 形式を基本とし、見出し・箇条書き・テーブルなどを用いて可読性を高める。
* テーブルを出力する際は、Markdown テーブルとして記述する。

### 4.3 推測と事実の区別

* ドキュメントに明示されている内容と、推測に基づく補完は必ず区別して扱う。
* 推測した内容は、「※推測」「※前提」「※仮定」などの注記を付ける。
* 機能名や画面名など、本文に登場する正式名称を可能な限りそのまま使用する。

### 4.4 禁止・注意事項

* ドキュメントにまったく根拠がない機能を、勝手に追加しない。
  （一般的にありそうでも、根拠がなければ「候補」として扱い、明示する。）
* テストケースの粒度を極端に細かくしすぎて、実務で扱えないレベルの分割は避ける。
* 単なる UI の説明やマニュアル文のコピペではなく、「テストで検証すべき観点」に変換することを意識する。

---

## 5. 手順概要

LLM は次の 2 段階で作業を行う。

1. **手順 1：機能一覧の抽出**

   * `function_identify_guide.md` に従って、機能のリストを作成する。
   * 粒度ごとにカテゴリ分けを行い、ツリー構造で一覧化する。
   * 各機能に「重要度」を付与する。
   * 結果を `result/function_list.md` に出力する。

2. **手順 2：機能テスト設計**

   * 手順 1 で作成した `result/function_list.md` を入力として使用する。
   * `functional_test_design_guide.md` に従って、機能テストのテストケースを設計する。
   * テーブル形式でテストケースを出力し、各テストケースに一意の ID を付与する。
   * 結果を `result/functional_test_cases.md` に出力する。

---

## 6. 手順 1：機能一覧の抽出ルール

### 6.1 目的

* ドキュメントに記載された情報をもとに、テスト対象となるアプリケーションの機能を漏れなく洗い出し、構造化する。
* テスト設計時に優先度をつけて着手できるよう、各機能に「重要度」を付与する。

### 6.2 入力

* 利用手順書 / 仕様書 / 要件定義書などのドキュメント群
* 本ファイル `rules.md`
* 詳細手順ファイル `function_identify_guide.md`

### 6.3 出力

* ファイル：`result/function_list.md`
* 内容（イメージ）：

  * 機能カテゴリと機能のツリー構造
  * 各機能の簡単な説明
  * 各機能の重要度（高 / 中 / 低 など）

### 6.4 機能抽出の基本方針

* ドキュメントから、「ユーザーが行う操作」や「システムが提供する処理単位」を探し、機能候補として列挙する。
* 類似した機能や同じ画面上で完結する機能は、1 つのカテゴリにまとめる。
* 機能の粒度は、後続の機能テストで 1〜数ケースにまとまりそうな大きさを目安とする。

### 6.5 カテゴリ分け・ツリー構造

* 可能であれば、以下のような多段構造を検討する。

  * 大カテゴリ：業務領域や大きな機能モジュール（例：請求管理、顧客管理）
  * 中カテゴリ：画面単位・ユースケース単位（例：請求書一覧画面、請求書編集画面）
  * 機能：具体的な操作・処理単位（例：請求書の新規登録、請求書の削除）

* ツリー構造は Markdown の箇条書きや見出しを用いて表現する。

### 6.6 重要度の付け方

* 重要度は、少なくとも 3 段階程度（例：高 / 中 / 低）で付与する。
* 判定の参考指標：

  * 業務への影響度（誤動作したときの影響範囲や深刻度）
  * 利用頻度（ほぼ毎日使うか、まれにしか使わないか）
  * 法令遵守・会計・セキュリティなど、クリティカルな要素との関係性
* ドキュメントから重要度を直接読み取れない場合、一般的な業務システムの観点から推測する。その場合は「※推測」と明記する。

---

## 7. 手順 2：機能テスト設計ルール

### 7.1 目的

* 手順 1 で抽出した機能一覧に基づき、網羅性の高い機能テストケースを設計する。
* テストケースをカテゴリと重要度で整理し、重要な箇所から優先的に実行できる状態を作る。

### 7.2 入力

* `result/function_list.md`（機能一覧）
* 本ファイル `rules.md`
* 詳細手順ファイル `functional_test_design_guide.md`

### 7.3 出力

* ファイル：`result/functional_test_cases.md`
* 形式：Markdown テーブル
* 各テストケースには **一意の ID** を付与する。

### 7.4 テストケース設計の基本方針

* 各機能について、正常系・代表的な異常系・バリデーション・境界値などを意識してテスト観点を洗い出す。
* 全体として、機能一覧に記載された機能がテストケースでカバーされていること（トレーサビリティ）を確保する。
* テストケースが複雑になりすぎる場合は、業務上意味のある単位で分割して ID を分ける。

### 7.5 テーブルの列の考え方（概要）

詳細な列定義は `functional_test_design_guide.md` で規定するが、少なくとも以下のような情報を含める。

* テストケース ID（ユニーク）
* カテゴリ（機能カテゴリ名など）
* 関連機能名（機能一覧との対応）
* テスト観点（例：最大値/最小値、必須入力、エラー時のメッセージなど）
* 重要度（元の機能の重要度に基づく）
* 前提条件
* 手順
* 期待結果
* 備考（仮定・制約など）

### 7.6 重要度とテスト粒度の関係

* 重要度「高」の機能：

  * 正常系・主要な異常系・代表的な境界値を、できるだけ明示的なテストケースとして列挙する。
* 重要度「中」「低」の機能：

  * 全てのパターンを列挙せず、代表的なケースに絞ることも許容される。
  * ただし、何を省略したか分かるようにテスト観点欄で示す。

---

## 8. 自己チェックリスト

LLM は各ステップの出力を作成した後、次の観点で自己チェックを行う。

### 機能一覧（`result/function_list.md`）のチェック

* ドキュメントに現れる主要な画面・業務フローは全て機能カテゴリまたは機能として取り込まれているか。
* 機能がツリー構造で整理されており、読んだ人が全体像を把握しやすいか。
* 各機能に重要度が設定されているか。
* 推測を行った箇所には「※推測」等の注記があるか。

### 機能テストケース（`result/functional_test_cases.md`）のチェック

* 各テストケースに一意の ID が付いているか。
* 機能一覧上の各機能について、少なくとも 1 件以上のテストケースが紐づいているか。
* テスト観点欄に、バリデーションや境界値などの観点が明示されているか。
* 重要度が高い機能について、テストが不足していないか。
* テーブル形式が崩れていないか（Markdown として解釈できるか）。

---

## 9. 実行順序のまとめ

LLM は、以下の順序でファイルを参照・実行する。

1. 本ファイル `rules.md` を読み、全体方針とルールを理解する。
2. `function_identify_guide.md` を参照し、入力ドキュメントから機能一覧を抽出し、
   `result/function_list.md` を作成する。
3. `functional_test_design_guide.md` を参照し、`result/function_list.md` をもとに機能テストケースを設計し、
   `result/functional_test_cases.md` を作成する。
