# functional_test_design_guide.md

LLM による機能テストケース設計ガイド

## 1. このファイルの役割

このファイルは、LLM に対して
**「機能一覧（function_list.md）を入力として、機能テストケースを設計するためのプロンプトテンプレート」**
を提供するガイド。

* 元になる情報：

  * `result/function_list.md`（機能一覧。rules.md / function_identify_guide.md に従って作成されたもの）
* LLM はまず `rules.md` を読み、そのルールに従いつつ、
  このファイルに記載されたテンプレートでプロンプトを構成し、
  **テーブル形式のテストケース一覧** を出力する。
* 出力結果は `result/functional_test_cases.md` に保存されることを想定する。

---

## 2. 使用イメージ（全体フロー）

1. オペレータが `result/function_list.md` を用意する。
2. 本ファイルの「プロンプトテンプレート」をベースに、
   `{{FUNCTION_LIST}}` などのプレースホルダに実際の機能一覧を埋め込む。
3. LLM にプロンプトを投げる。
4. LLM が `result/functional_test_cases.md` にそのまま保存可能な Markdown テーブルを出力する。

---

## 3. プロンプトテンプレート（本体）

以下のテンプレートを、LLM に投げるプロンプトのベースとして使用する。

### 3.1 基本テンプレート

````text
あなたは業務システムのテスト設計を支援するアシスタントです。  
これから渡す機能一覧（function_list.md）を読み、  
rules.md のルールに従って **機能テストのテストケース** を設計してください。

# 前提

- あなたはすでに `rules.md` を読み、  
  「手順 2：機能テスト設計」の目的・ルール・重要度とテスト粒度の関係を理解しているものとします。
- 機能一覧は `result/function_list.md` と同等の形式で渡されます。
- 今回のタスクで行うのは **機能テストのテストケース設計** です。  
  機能一覧そのものの再整理は原則として行わないでください（明らかな誤りを除く）。

# 入力（機能一覧）

以下が対象システムの機能一覧です。  
この内容をもとに、機能テストケースを設計してください。

<<<FUNCTION_LIST_START>>>
{{FUNCTION_LIST}}
<<<FUNCTION_LIST_END>>>

# タスク

1. 各機能（機能ID・機能名・重要度）を読み取り、  
   その機能を検証するためのテストケースを設計してください。
2. 各テストケースには、一意なテストケースIDを付与してください。  
   - 例：`TC-001`, `TC-002` …  
   - 機能IDとの対応が分かるように、必要であれば命名ルールを工夫してください（例：`TC-F001-01` など）。
3. テストケースは **Markdown テーブル形式** で出力してください。
4. テーブルには、少なくとも次の列を含めてください。

   - `TestCaseID`（テストケースID）
   - `カテゴリ`（機能カテゴリ・画面・業務領域など、function_list.md に基づく分類）
   - `機能ID`（function_list.md の機能ID）
   - `機能名`
   - `重要度`（機能一覧の重要度を引き継ぐ）
   - `テスト観点`
   - `前提条件`
   - `手順`
   - `期待結果`
   - `備考`（任意。推測や制約事項、未確定事項など）

5. `テスト観点` 列には、テストの意図や観点を短く記述してください。  
   - 例：  
     - 正常系（基本フロー）
     - 必須入力チェック
     - 最大値/最小値チェック
     - 文字数制限
     - 範囲チェック
     - 権限制御
     - 異常系（外部サービスエラー）
6. 重要度が「高」の機能については、正常系・代表的な異常系・バリデーション・境界値などをできるだけ明示的に分けてテストケースを列挙してください。
7. 重要度が「中」「低」の機能については、代表的なケースを中心に列挙し、  
   省略している観点がある場合は `テスト観点` や `備考` に簡潔に記載してください。

# 出力形式

出力は、`result/functional_test_cases.md` としてそのまま保存できる **Markdown 形式** のテーブルとしてください。

1. ファイル先頭に、対象システム名が分かる場合はタイトルを付けてください。
2. その下に、テストケース一覧をカテゴリ単位でまとめてください。
   - 例：カテゴリごとに見出し（`## 請求管理` など）を付け、その配下にテーブルを置く。
3. テーブルの例：

```markdown
# 機能テストケース一覧（○○システム）

## 請求管理

| TestCaseID | カテゴリ         | 機能ID | 機能名                     | 重要度 | テスト観点             | 前提条件                         | 手順                                                                 | 期待結果                                                         | 備考 |
|-----------|------------------|--------|----------------------------|--------|------------------------|----------------------------------|----------------------------------------------------------------------|------------------------------------------------------------------|------|
| TC-001    | 請求書一覧画面   | F-001  | 請求書一覧の表示           | 高     | 正常系（基本表示）     | 有効な請求書データが1件以上存在 | メインメニューから請求書一覧画面を開く                              | 登録済みの請求書が一覧に表示される                               |      |
| TC-002    | 請求書一覧画面   | F-002  | 請求書一覧の検索・絞り込み | 高     | 検索条件の組み合わせ   | 複数の顧客・期間の請求書が存在     | 顧客名と期間を指定して検索ボタンを押下                             | 条件に一致する請求書のみが表示される                             |      |
| TC-003    | 請求書一覧画面   | F-002  | 請求書一覧の検索・絞り込み | 高     | 部分一致/存在しない値 | 顧客が複数存在                    | 存在しない顧客名を入力して検索ボタンを押下                         | 検索結果が0件となり、適切なメッセージが表示される（※推測）       | メッセージ内容は仕様未記載のため仮定 |

## 顧客管理

| TestCaseID | カテゴリ       | 機能ID | 機能名         | 重要度 | テスト観点           | 前提条件                   | 手順                                                             | 期待結果                                             | 備考 |
|-----------|----------------|--------|----------------|--------|----------------------|----------------------------|------------------------------------------------------------------|------------------------------------------------------|------|
| TC-100    | 顧客マスタ画面 | F-100  | 顧客の新規登録 | 高     | 正常系（必須項目）   | なし                       | 顧客マスタ画面を開き、必須項目のみを入力して登録ボタンを押下   | エラーなく新規顧客が登録され、一覧に表示される       |      |
| TC-101    | 顧客マスタ画面 | F-100  | 顧客の新規登録 | 高     | 必須入力チェック     | なし                       | 顧客名を空欄のまま登録ボタンを押下                             | 必須項目のエラーメッセージが表示され、登録されない   |      |
| TC-102    | 顧客マスタ画面 | F-100  | 顧客の新規登録 | 中     | 文字数上限チェック   | なし                       | 顧客名に文字数上限 + 1 文字を入力し、登録ボタンを押下          | 上限を超えた入力としてエラーとなり、登録されない     | 文字数上限は仕様から読み取れる範囲で記載すること |
````

4. テーブルはカテゴリ単位で分けても、全カテゴリを 1 つの大テーブルにまとめても構いません。
   ただし、**カテゴリ列は必須** とし、全体を俯瞰しやすい構成にしてください。

# 注意事項

* 機能一覧に記載されていない機能を前提とするテストケースは、原則として作成しないでください。
  どうしても必要な場合は `備考` に「※推測」と明記してください。
* テストケースの粒度は、「テストの実行者が迷わずに実行でき、期待結果が明確に判定できる」レベルを目安としてください。
* 一つのテストケースに観点を詰め込みすぎないようにし、
  重要な観点は別のテストケースに分割することを検討してください。
* 重要度が高い機能について、正常系のみで終わらないように注意してください。
  エラー・境界値・権限など、リスクの高い観点を優先的に補うこと。

以上のルールに従って、`result/functional_test_cases.md` を作成してください。

````

---

## 4. 列定義と設計ルールの補足

ここからは、テンプレート内でざっくり触れている部分をもう少しだけ具体化しておく。

### 4.1 列の想定定義

- **TestCaseID**
  - テストケースごとに一意のID。
  - 機能IDと紐づけたい場合は `TC-<機能ID>-<連番>` のような形式も可。
- **カテゴリ**
  - function_list.md のカテゴリ（業務領域 / 画面 / モジュールなど）をそのまま利用するか、  
    必要に応じて再構成してもよい。
- **機能ID / 機能名**
  - function_list.md と一致させることでトレーサビリティを確保する。
- **重要度**
  - 基本は機能一覧の重要度をそのまま引き継ぐ。
  - 機能は同じでもテスト観点によってリスクが大きく異なる場合、備考で補足してもよい。
- **テスト観点**
  - 「このテストで何を確認したいか」のラベル。
  - 例）正常系、必須項目、最大値/最小値、NULL/空文字、整合性チェック、権限、パフォーマンス（軽いレベル）、など。
- **前提条件**
  - 事前に作成しておくべきデータ、ログイン状態、権限など。
  - 前提が複雑すぎる場合は、テストデータ準備用の別テストケースに切り出すことも検討する。
- **手順**
  - 実行者が迷わないレベルで、手順をステップ形式で記述する。
  - 1 ケースあたり、数行〜10行程度を目安とする。
- **期待結果**
  - 判定基準を明確にする。
  - 画面表示・DB更新・メッセージ表示・外部インターフェースへの影響などを記載する。
- **備考**
  - 推測で補完した内容、未確定仕様、環境依存の注意点など。

### 4.2 重要度とテスト数のイメージ

- 重要度「高」
  - 正常系（基本フロー）
  - 主要な異常系
  - 必須項目、形式チェック、境界値
  - 権限/ロールが絡む場合は、代表的なパターン
- 重要度「中」
  - 正常系 + 代表的なバリデーション
- 重要度「低」
  - 正常系を中心に、致命度が高そうな観点に絞る

---

## 5. Few-shot 例

LLM に「こういう雰囲気でテーブルを作ってほしい」というイメージを伝えるためのサンプル。

### 5.1 サンプル function_list.md（抜粋）

```markdown
# 機能一覧（サンプルシステム）

## 1. 共通

### 1-1. ログイン

| 機能ID | 機能名           | 重要度 | 概要                                                         |
|--------|------------------|--------|--------------------------------------------------------------|
| F-001  | ログイン認証     | 高     | ユーザーIDとパスワードを入力してシステムにログインする機能。|
| F-002  | アカウントロック | 高     | パスワード誤入力が一定回数を超えた場合にアカウントをロックする機能。 |

## 2. 顧客管理

### 2-1. 顧客検索

| 機能ID | 機能名         | 重要度 | 概要                                           |
|--------|----------------|--------|------------------------------------------------|
| F-010  | 顧客の検索     | 高     | 顧客名または顧客コードを条件に、顧客を検索する機能。|
| F-011  | 顧客詳細の表示 | 中     | 検索結果から選択した顧客の詳細情報を表示する機能。|
````

### 5.2 期待される functional_test_cases.md（イメージ）

```markdown
# 機能テストケース一覧（サンプルシステム）

## 共通

| TestCaseID | カテゴリ | 機能ID | 機能名       | 重要度 | テスト観点               | 前提条件                       | 手順                                                                                     | 期待結果                                                                 | 備考 |
|-----------|----------|--------|--------------|--------|--------------------------|--------------------------------|------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|------|
| TC-F001-01| ログイン | F-001  | ログイン認証 | 高     | 正常系（有効な資格情報） | 有効なユーザーID・パスワードが存在 | ログイン画面を開き、有効なユーザーIDとパスワードを入力して「ログイン」ボタンを押下する | メインメニュー画面が表示され、ログイン中ユーザー名が正しく表示される   |      |
| TC-F001-02| ログイン | F-001  | ログイン認証 | 高     | 異常系（誤ったパスワード）| 有効なユーザーIDが存在         | ログイン画面で正しいユーザーIDと誤ったパスワードを入力し「ログイン」ボタンを押下する   | ログインに失敗し、認証エラーのメッセージが表示される                   |      |
| TC-F002-01| ログイン | F-002  | アカウントロック | 高  | アカウントロック条件     | 対象ユーザーがロックされていない | 誤ったパスワードで連続してログインを試行し、ロック条件回数を超えたタイミングで確認する | アカウントがロックされ、それ以降正しいパスワードでもログインできない   | ロック条件の回数は仕様に合わせること |

## 顧客管理

| TestCaseID | カテゴリ   | 機能ID | 機能名         | 重要度 | テスト観点               | 前提条件                      | 手順                                                                 | 期待結果                                                           | 備考 |
|-----------|------------|--------|----------------|--------|--------------------------|-------------------------------|----------------------------------------------------------------------|--------------------------------------------------------------------|------|
| TC-F010-01| 顧客検索   | F-010  | 顧客の検索     | 高     | 正常系（完全一致）       | 対象顧客が事前に登録されている | 顧客検索画面を開き、顧客コードを入力して検索ボタンを押下           | 該当顧客のみが検索結果に表示される                                 |      |
| TC-F010-02| 顧客検索   | F-010  | 顧客の検索     | 中     | 部分一致/存在しない値   | 顧客データが複数件存在        | 存在しない顧客名を入力して検索ボタンを押下                         | 検索結果が0件となり、必要に応じて0件であることが分かる表示となる | メッセージ有無は仕様によって異なる（※推測） |
| TC-F011-01| 顧客詳細   | F-011  | 顧客詳細の表示 | 中     | 正常系（遷移と表示内容） | 対象顧客が検索で1件ヒットする | 検索結果一覧から任意の顧客を選択し、詳細表示を実行する             | 顧客詳細画面に遷移し、名称・住所・連絡先などが正しく表示される     |      |
```
